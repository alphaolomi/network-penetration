#!/usr/bin/python 2 3 import sys 4 import socket 5 from random import randint 6 7 if len(sys.argv) < 2: 8 print sys.argv[0] + ": <start_ip>-<stop_ip>" 9 sys.exit(1) 10 11 12 def get_ips(start_ip, stop_ip): 13 ips = [] 14 tmp = [] 15 16 for i in start_ip.split(’.’): 17 tmp.append("%02X" % long(i)) 18 19 start_dec = long(’’.join(tmp), 16) 20 tmp = [] 21 22 for i in stop_ip.split(’.’): 23 tmp.append("%02X" % long(i)) 24 25 stop_dec = long(’’.join(tmp), 16) 26 27 while(start_dec < stop_dec + 1): 28 bytes = [] 29 bytes.append(str(int(start_dec / 16777216))) 30 rem = start_dec % 16777216 31 bytes.append(str(int(rem / 65536))) 32 rem = rem % 65536 33 bytes.append(str(int(rem / 256))) 34 rem = rem % 256 35 bytes.append(str(rem)) 36 ips.append(".".join(bytes)) 37 start_dec += 1 38 39 return ips 40
6.6 Reverse DNS Scanner 79
41 42 def dns_reverse_lookup(start_ip, stop_ip): 43 ips = get_ips(start_ip, stop_ip) 44 45 while len(ips) > 0: 46 i = randint(0, len(ips) - 1) 47 lookup_ip = str(ips[i]) 48 49 try: 50 print lookup_ip + ":"+\ 51 str(socket.gethostbyaddr(lookup_ip)[0]) 52 except (socket.herror, socket.error): 53 pass 54 55 del ips[i] 56 57 start_ip, stop_ip = sys.argv[1].split(’-’) 58 dns_reverse_lookup(start_ip, stop_ip) 