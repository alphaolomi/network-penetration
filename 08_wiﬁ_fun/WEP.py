#!/usr/bin/python 2 3 import sys 4 from scapy.all import * 5 6 iface = "wlan0" 7 nr_of_wep_packets = 40000 8 packets = [] 9 10 # This function will be called for every sniffed packet 11 def handle_packet(packet): 12 13 # Got WEP packet? 14 if packet.haslayer(Dot11WEP): 15 packets.append(packet) 16 17 print "Paket " + str(len(packets)) + ":"+\ 18 packet[Dot11].addr2 + " IV: " + str(packet.iv) + \ 19 " Keyid: " + str(packet.keyid) + \ 20 " ICV: " + str(packet.icv) 21 22 # Got enough packets to crack wep key? 23 # Save them to pcap file and exit 24 if len(packets) == nr_of_wep_packets: 25 wrpcap("wpa_handshake.pcap", wpa_handshake) 26 sys.exit(0) 27
122 8 WiÔ¨Å Fun
28 # Set device into monitor mode 29 os.system("iwconfig " + iface + " mode monitor") 30 31 # Start sniffing 32 print "Sniffing on interface " + iface 33 sniff(iface=iface, prn=handle_packet)
